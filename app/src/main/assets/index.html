
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/main.css" rel="stylesheet">
    <title>112823</title>
</head>
<body>

<!-- Title Screen -->
<div class="full-screen" id="title-screen">
    <h1>112823</h1>
    <h3>title_screen_placeholder</h3>
    <p>Tap to start</p>
    <a href="#scrapbook" class="button">start</a>
    <div class="footer">Made with love from Kyle Genesis Fernando</div>
</div>
<!-- Scrapbook Section -->
<div class="container" id="scrapbook" style="display: none;">
    <h1 style="font-size: 30px">title_placeholder</h1>

    <div class="separator"></div>

    <div class="separator"></div>

    <h2>text_placeholder</h2>
    <div id="entriesContainer"></div>


    <div class="add-entry-container">
        <h4 style="text-align: center; font-size: 25px;">Add own photos and notes</h4>
        <h4 style="text-align: center; font-size: 20px;">this is only a proof of concept</h4>
        <textarea id="noteInput" placeholder="Write your notes here..." class="add-entry-textarea"></textarea>

        <div class="image-upload-container">
            <label for="imageInput" class="image-upload-label">
                <span>Choose Image</span>
                <input type="file" id="imageInput" accept="image/*" capture="camera" class="add-entry-file" />
            </label>
            <img id="imagePreview" class="image-preview" alt="Image Preview" />
        </div>

        <button id="addButton" class="add-entry-button">Add Entry</button>
        <br>
        <button id="jiggleButton" class="add-entry-button red-button">Delete an entry</button>
    </div>



    <div class="separator"></div>
    <button onclick="Android.exportDomStorage()">Export DOM Data</button>
    <button onclick="Android.importDomStorage()">Import DOM Data</button>
    <div class="separator"></div>
    <div class="footer"><p>poc</p></div>
</div>


    <script>
	// Function to back up all DOM storage (including scrapbook entries and images)
     function getDomStorageData() {
         let data = {};

         // Backup scrapbook entries
         let scrapbookEntries = localStorage.getItem('scrapbookEntries');
         if (scrapbookEntries) {
             data['scrapbookEntries'] = scrapbookEntries; // Store entries as JSON string
         }

         return JSON.stringify(data); // Convert to JSON for saving
     }

     // Function to restore all DOM storage (including scrapbook entries and images)
     function restoreDomStorageData(data) {
         let parsedData = JSON.parse(data);

         // Restore scrapbook entries
         if (parsedData['scrapbookEntries']) {
             localStorage.setItem('scrapbookEntries', parsedData['scrapbookEntries']);
         }

         // Reload the entries after restoration
         loadEntries();
     }

     document.querySelector('.button').onclick = function() {
         const titleScreen = document.getElementById('title-screen');
         titleScreen.classList.add('hidden'); // Add the hidden class to start the fade-out
         setTimeout(() => {
             titleScreen.style.display = 'none'; // Hide after the transition
             document.getElementById('scrapbook').style.display = 'block';
             loadEntries(); // Load existing entries when entering the scrapbook
         }, 500); // Match the timeout with the CSS transition duration
     };

     document.addEventListener('DOMContentLoaded', function() {
         const scrapbook = document.getElementById('scrapbook');
         scrapbook.style.display = 'none'; // Ensure scrapbook is hidden initially

         document.getElementById('addButton').onclick = function() {
             const noteInput = document.getElementById('noteInput');
             const imageInput = document.getElementById('imageInput');

             if (noteInput.value.trim() === "") {
                 alert("Please write a note.");
                 return;
             }

             saveEntry(noteInput.value, imageInput.files[0]);

             // Clear the input fields
             noteInput.value = '';
             imageInput.value = '';
             document.getElementById('imagePreview').style.display = 'none'; // Hide the preview
         };

         document.getElementById('imageInput').onchange = function(event) {
             const file = event.target.files[0];
             const reader = new FileReader();

             reader.onload = function(e) {
                 const imagePreview = document.getElementById('imagePreview');
                 imagePreview.src = e.target.result; // Set the preview source
                 imagePreview.style.display = 'block'; // Show the preview
             };

             if (file) {
                 reader.readAsDataURL(file);
             } else {
                 document.getElementById('imagePreview').style.display = 'none'; // Hide if no file
             }
         };

         // Toggle jiggle mode
         document.getElementById('jiggleButton').onclick = function() {
             isJiggling = !isJiggling;
             loadEntries(); // Refresh to show/hide delete buttons
         };
     });

     let isJiggling = false; // State for jiggle mode

     function saveEntry(note, imageFile) {
         let entries = JSON.parse(localStorage.getItem('scrapbookEntries')) || [];
         const reader = new FileReader();

         reader.onload = function(event) {
             const newEntry = {
                 note: note,
                 image: event.target.result // Base64 string of the image
             };
             entries.push(newEntry);
             localStorage.setItem('scrapbookEntries', JSON.stringify(entries));
             loadEntries(); // Load entries after saving
         };

         reader.onerror = function() {
             alert("Failed to read file. Please try again.");
         };

         if (imageFile) {
             reader.readAsDataURL(imageFile);
         } else {
             saveEntryWithoutImage(note);
         }
     }

     function saveEntryWithoutImage(note) {
         let entries = JSON.parse(localStorage.getItem('scrapbookEntries')) || [];
         entries.push({ note: note, image: null });
         localStorage.setItem('scrapbookEntries', JSON.stringify(entries));
         loadEntries(); // Load entries after saving
     }

     function loadEntries() {
         const entriesContainer = document.getElementById('entriesContainer');
         entriesContainer.innerHTML = ''; // Clear existing entries

         let entries = JSON.parse(localStorage.getItem('scrapbookEntries')) || [];

         entries.forEach((entry, index) => {
             const entryDiv = document.createElement('div');
             entryDiv.className = 'entry';
             entryDiv.innerHTML = `
                 <p>${entry.note}</p>
                 ${entry.image ? `<img src="${entry.image}" alt="Entry Image" />` : ''}
                 ${isJiggling ? `<button class="delete-entry-button" onclick="deleteEntry(${index})">Delete</button>` : ''}
             `;
             entriesContainer.appendChild(entryDiv);
         });
     }

     function deleteEntry(index) {
         let entries = JSON.parse(localStorage.getItem('scrapbookEntries')) || [];
         entries.splice(index, 1); // Remove the entry
         localStorage.setItem('scrapbookEntries', JSON.stringify(entries));
         loadEntries(); // Reload entries after deletion
     }

     function handleImageSelection(imageUri) {
         // Process the image URI (for example, show it in an <img> tag)
         const imagePreview = document.getElementById('imagePreview');
         imagePreview.src = imageUri; // Display the selected image
         imagePreview.style.display = 'block'; // Show the image preview
     }
     </script>

<script src="js/bootstrap.bundle.min.js"></script>


</body>
</html>
